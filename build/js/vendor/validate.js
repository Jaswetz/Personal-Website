/*
 * validate.js 1.2
 * Copyright (c) 2012 Rick Harrison, http://rickharrison.me
 * validate.js is open sourced under the MIT license.
 * Portions of validate.js are inspired by CodeIgniter.
 * http://rickharrison.github.com/validate.js
 */
(function(e,t,n){var r={messages:{required:"The %s field is required.",matches:"The %s field does not match the %s field.",valid_email:"The %s field must contain a valid email address.",valid_emails:"The %s field must contain all valid email addresses.",min_length:"The %s field must be at least %s characters in length.",max_length:"The %s field must not exceed %s characters in length.",exact_length:"The %s field must be exactly %s characters in length.",greater_than:"The %s field must contain a number greater than %s.",less_than:"The %s field must contain a number less than %s.",alpha:"The %s field must only contain alphabetical characters.",alpha_numeric:"The %s field must only contain alpha-numeric characters.",alpha_dash:"The %s field must only contain alpha-numeric characters, underscores, and dashes.",numeric:"The %s field must contain only numbers.",integer:"The %s field must contain an integer.",decimal:"The %s field must contain a decimal number.",is_natural:"The %s field must contain only positive numbers.",is_natural_no_zero:"The %s field must contain a number greater than zero.",valid_ip:"The %s field must contain a valid IP.",valid_base64:"The %s field must contain a base64 string.",valid_credit_card:"The %s field must contain a vaild credit card number",is_file_type:"The %s field must contain only %s files."},callback:function(e){}},i=/^(.+?)\[(.+)\]$/,s=/^[0-9]+$/,o=/^\-?[0-9]+$/,u=/^\-?[0-9]*\.?[0-9]+$/,a=/^[a-zA-Z0-9.!#$%&amp;'*+-/=?\^_`{|}~-]+@[a-zA-Z0-9-]+(?:\.[a-zA-Z0-9-]+)*$/,f=/^[a-z]+$/i,l=/^[a-z0-9]+$/i,c=/^[a-z0-9_-]+$/i,h=/^[0-9]+$/i,p=/^[1-9][0-9]*$/i,d=/^((25[0-5]|2[0-4][0-9]|1[0-9]{2}|[0-9]{1,2})\.){3}(25[0-5]|2[0-4][0-9]|1[0-9]{2}|[0-9]{1,2})$/i,v=/[^a-zA-Z0-9\/\+=]/i,m=/^[\d\-\s]+$/,g=function(e,n,i){this.callback=i||r.callback,this.errors=[],this.fields={},this.form=t.forms[e]||{},this.messages={},this.handlers={};for(var s=0,o=n.length;s<o;s++){var u=n[s];if(!u.name||!u.rules)continue;this.fields[u.name]={name:u.name,display:u.display||u.name,rules:u.rules,id:null,type:null,value:null,checked:null}}this.form.onsubmit=function(e){return function(t){try{return e._validateForm(t)}catch(n){}}}(this)},y=function(e,t){var n;if(e.length>0&&e[0].type==="radio"){for(n=0;n<e.length;n++)if(e[n].checked)return e[n][t];return}return e[t]};g.prototype.setMessage=function(e,t){return this.messages[e]=t,this},g.prototype.registerCallback=function(e,t){return e&&typeof e=="string"&&t&&typeof t=="function"&&(this.handlers[e]=t),this},g.prototype._validateForm=function(e){this.errors=[];for(var t in this.fields)if(this.fields.hasOwnProperty(t)){var r=this.fields[t]||{},i=this.form[r.name];i&&i!==n&&(r.id=y(i,"id"),r.type=i.length>0?i[0].type:i.type,r.value=y(i,"value"),r.checked=y(i,"checked")),this._validateField(r)}typeof this.callback=="function"&&this.callback(this.errors,e);if(this.errors.length>0){if(!e||!e.preventDefault)return!1;e.preventDefault()}return!0},g.prototype._validateField=function(e){var t=e.rules.split("|");if(e.rules.indexOf("required")===-1&&(!e.value||e.value===""||e.value===n))return;for(var s=0,o=t.length;s<o;s++){var u=t[s],a=null,f=!1,l=i.exec(u);l&&(u=l[1],a=l[2]),typeof this._hooks[u]=="function"?this._hooks[u].apply(this,[e,a])||(f=!0):u.substring(0,9)==="callback_"&&(u=u.substring(9,u.length),typeof this.handlers[u]=="function"&&this.handlers[u].apply(this,[e.value])===!1&&(f=!0));if(f){var c=this.messages[u]||r.messages[u],h="An error has occurred with the "+e.display+" field.";c&&(h=c.replace("%s",e.display),a&&(h=h.replace("%s",this.fields[a]?this.fields[a].display:a))),this.errors.push({id:e.id,name:e.name,message:h,rule:u});break}}},g.prototype._hooks={required:function(e){var t=e.value;return e.type==="checkbox"||e.type==="radio"?e.checked===!0:t!==null&&t!==""},matches:function(e,t){var n=this.form[t];return n?e.value===n.value:!1},valid_email:function(e){return a.test(e.value)},valid_emails:function(e){var t=e.value.split(",");for(var n=0;n<t.length;n++)if(!a.test(t[n]))return!1;return!0},min_length:function(e,t){return s.test(t)?e.value.length>=parseInt(t,10):!1},max_length:function(e,t){return s.test(t)?e.value.length<=parseInt(t,10):!1},exact_length:function(e,t){return s.test(t)?e.value.length===parseInt(t,10):!1},greater_than:function(e,t){return u.test(e.value)?parseFloat(e.value)>parseFloat(t):!1},less_than:function(e,t){return u.test(e.value)?parseFloat(e.value)<parseFloat(t):!1},alpha:function(e){return f.test(e.value)},alpha_numeric:function(e){return l.test(e.value)},alpha_dash:function(e){return c.test(e.value)},numeric:function(e){return u.test(e.value)},integer:function(e){return o.test(e.value)},decimal:function(e){return u.test(e.value)},is_natural:function(e){return h.test(e.value)},is_natural_no_zero:function(e){return p.test(e.value)},valid_ip:function(e){return d.test(e.value)},valid_base64:function(e){return v.test(e.value)},valid_credit_card:function(e){if(!m.test(e.value))return!1;var t=0,n=0,r=!1,i=e.value.replace(/\D/g,"");for(var s=i.length-1;s>=0;s--){var o=i.charAt(s),n=parseInt(o,10);r&&(n*=2)>9&&(n-=9),t+=n,r=!r}return t%10==0},is_file_type:function(e,t){if(e.type!=="file")return!0;var n=e.value.substr(e.value.lastIndexOf(".")+1),r=t.split(","),i=!1,s=0,o=r.length;for(s;s<o;s++)n==r[s]&&(i=!0);return i}},e.FormValidator=g})(window,document);